<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>HTMX/Rust Todo</title>
  </head>
  <body>
    <h1>My Todos</h1>
    <div>
      |--TODOS PLACEHOLDER--|
    </div>
    <input type="text" />
    <button type="submit">Create New Todo</button>
    <script>
      const input = document.querySelector("input");
      const button = document.querySelector("button");
      const div = document.querySelector("div");

      const create_new_todo = async () => {
        console.log("Attempting to create new todo:", input.value)
        if (input.value === '') {
          alert("Please enter a todo.");
          return;
        }

        const fd = new FormData();

        fd.set("todo", input.value);

        try {
          const response = await fetch("http://127.0.0.1:3000/create", {
            method: "POST",
            body: fd
          });
          const text = await response.text();
          div.innerHTML = text;

          console.log("Replaced HTML");
        } catch(e) {
          console.error(e);
        }

        input.value = "";

        console.log("Created new todo:", input.value)
      }

      button.addEventListener("click", create_new_todo);
    </script>
  </body>
</html>